country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100)
View(corr)
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100) %>%
mutate_if(is.numeric, round, digits = 2)
asia <- c("Russia", "Thailand", "Japan", "Taiwan", "South Korea", "Hong Kong", "Malaysia", "China", "Philippines", "Vietnam", "Bangladesh", "Singapore", "Indonesia", "India", "Pakistan", "Nepal", "Myanmar", "Cambodia", "Dubai")
europe <- c("France", "Ukraine", "Netherlands", "Italy", "Poland", "Germany", "Hungary", "United Kingdom", "Finland", "Sweden", "Estonia")
oceania <- c("Australia", "New Zealand", "Fiji")
africa <- c("Nigeria", "Ghana")
america <- c("Canada", "United States", "Brazil", "Mexico", "Colombia")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100) %>%
mutate_if(is.numeric, round, digits = 2)
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100) %>%
mutate(scales::percent(percentage/100, 0.1))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.1))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
mutate(percentage = n(continent)/nrow(corr)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.1))
?n
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
summarise(percentage = n/sum(n)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.1))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.1))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.01))
View(corr)
View(corr)
View(corr)
View(corr)
slices <- c(0.13, 14.52, 79.64, 4.76, 0.96)
lbls <- c("Africa", "America", "Asia", "Europe", "Oceania")
pie(slices, labels = lbls, main="Pie Chart of Countries")
ggplot(corr, aes(x = continent, y = percentage)) +
geom_col() +
scale_colour_brewer(palette = "Dark2") +
ggtitle("Count of ratings based on continent")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100) %>%
mutate(percentage = scales::percent(percentage/100, 0.01))
ggplot(corr, aes(x = continent, y = percentage)) +
geom_col() +
scale_colour_brewer(palette = "Dark2") +
ggtitle("Count of ratings based on continent")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100) %>%
mutate_if(is.numeric, round, digits = 2)
View(corr)
ggplot(corr, aes(x="", y=percentage, fill=continent))+
geom_bar(width = 1, stat = "identity")
ggplot(corr, aes(x="", y=percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0)
ggplot(corr, aes(x="", y=percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(label = scales::percent(percentage/100, 0.01), size=5)
View(corr)
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(label = scales::percent(percentage/100, 0.01), size=5)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = scales::percent(percentage/100, 0.01)), size=5)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = scales::percent(percentage, 0.01)), size=5)
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = scales::percent(percentage, 0.01)), size=5)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = percentage, size=5))
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = percentage, size=3))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(label = percentage, size=3))
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = value/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = percentage, size=3))
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = percentage, size=3))
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = percentage, size=1))
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = percent(percentage/100)), size=1)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=1)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/4 + c(0, cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=3)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/3 + c(0, cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=2)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/5 + c(0, cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=2)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = percentage/6 + c(0, cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=2)
worst <- ramen_ratings %>%
filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
datatable(options = list(paging = TRUE)) %>%
formatRound(columns = c("Brand", "Number of ramen"), caption = "Top 5 brand with worst rated ramen"))
worst <- ramen_ratings %>%
filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
datatable(options = list(paging = TRUE)) %>%
formatRound(columns = c("Brand", "Number of ramen"), caption = "Top 5 brand with worst rated ramen")
worst <- ramen_ratings %>%
filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
kableExtra::kable(col.names = c("Brand", "Number of ramen"), caption = "Top 5 brand with worst rated ramen")
worst
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = c(0,cumsum(percentage)[-length(percentage)]),
label = scales::percent(percentage/100)), size=2)
ggplot(corr, aes(x="", y= percentage, fill=continent))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text.x=element_blank()) +
geom_text(aes(y = cumsum(percentage)),
label = scales::percent(percentage/100), size=2)
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"))
corr
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
worst <- ramen_ratings %>%
filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
datatable(colnames = c("Brand", "Number of ramen"), options = list(paging = FALSE), caption = "Top 5 brands with worst rated ramen")
worst
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
group_by(continent, stars) %>%
summarise(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
corr <- corr %>%
group_by(continent, stars) %>%
summarise(percentage = n()/sum(n())*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
View(corr)
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
ggplot(brands, aes(x = reorder(brand, n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 1.25, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
ggplot(brands, aes(x = reorder(brand, -n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 0.5, vjust = 1, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
ggplot(brands, aes(x = reorder(brand, -n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 0.5, vjust = 1.5, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
perc
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
View(best)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
summarise(mean = mean(stars))
