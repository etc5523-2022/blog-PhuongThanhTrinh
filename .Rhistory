filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
datatable(colnames = c("Brand", "Number of ramen"), options = list(paging = FALSE), caption = "Top 5 brands with worst rated ramen")
worst
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
View(corr)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
group_by(continent, stars) %>%
summarise(percentage = n/sum(n)*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
corr <- corr %>%
group_by(continent, stars) %>%
summarise(percentage = n()/sum(n())*100,
Average_rate = mean(stars))  %>%
mutate_if(is.numeric, round, digits = 2)
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
View(corr)
corr <- corr %>%
count(continent, stars) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
corr <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
ggplot(brands, aes(x = reorder(brand, n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 1.25, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
ggplot(brands, aes(x = reorder(brand, -n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 0.5, vjust = 1, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
ggplot(brands, aes(x = reorder(brand, -n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 0.5, vjust = 1.5, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
perc
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
View(best)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
summarise(mean = mean(stars))
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
library(tidyverse)
library(ggplot2)
library(DT)
library(plotly)
library(visdat)
ramen_ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-04/ramen_ratings.csv")
vis_miss(ramen_ratings)
ramen_ratings <- ramen_ratings %>%
filter(stars != is.na(stars))
ramen_ratings <- ramen_ratings %>%
mutate(country = ifelse(country == "Sarawak", "Malaysia", country),
country = ifelse(country == "USA", "United States", country),
country = ifelse(country == "UK", "United Kingdom", country),
country = ifelse(country == "Phlippines", "Philippines", country),
country = ifelse(country == "Holland", "Netherlands", country))
ramen_ratings %>%
rename(Country = country) %>%
group_by(Country) %>%
summarise(Average = mean(stars),
Min = min(stars),
Median = median(stars),
Max = max(stars)) %>%
datatable(options = list(paging = TRUE)) %>%
formatRound(columns = c("Min", "Average", "Median", "Max"), digits = 1)
brands <- ramen_ratings %>%
count(brand) %>%
mutate(Rank = rank(-n)) %>%
filter(Rank <= 10) %>%
mutate_if(is.numeric, round, digits = 2)
ggplot(brands, aes(x = reorder(brand, -n),
y = n)) +
geom_col(color = "black", fill = "#669933") +
geom_col(data = ~filter(.x, brand == "Nissin"),
fill = "#FFCC66") +
geom_text(aes(label = n), hjust = 0.5, vjust = 1.5, color = "black") +
labs(x = "Ramen brand", y = "Number of ramen") +
theme_bw()+
ggtitle("Figure 2. Number of ramen varieties based on brands")
ggplot(ramen_ratings, aes(x = stars)) +
geom_histogram(color = "purple", fill = "purple", alpha = 0.2, bins = 20, aes(y = stat(density))) +
geom_density(color = "purple", fill = "purple", alpha = 0.2) +
labs(x = "Rating", y = "Number of ramen brands") +
ggtitle("Histogram of ratings across brands")
worst <- ramen_ratings %>%
filter(stars < 3) %>%
group_by(brand) %>%
count(brand) %>%
arrange(-n) %>%
head(5) %>%
datatable(colnames = c("Brand", "Number of ramen"), options = list(paging = FALSE), caption = "Top 5 brands with worst rated ramen")
worst
asia <- c("Russia", "Thailand", "Japan", "Taiwan", "South Korea", "Hong Kong", "Malaysia", "China", "Philippines", "Vietnam", "Bangladesh", "Singapore", "Indonesia", "India", "Pakistan", "Nepal", "Myanmar", "Cambodia", "Dubai")
europe <- c("France", "Ukraine", "Netherlands", "Italy", "Poland", "Germany", "Hungary", "United Kingdom", "Finland", "Sweden", "Estonia")
oceania <- c("Australia", "New Zealand", "Fiji")
africa <- c("Nigeria", "Ghana")
america <- c("Canada", "United States", "Brazil", "Mexico", "Colombia")
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa"))
perc <- corr %>%
count(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Number of ramen", "Percentage"), options = list(paging = FALSE))
perc
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
View(best)
sum(best$n)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
best$stars <- as.factor(best$stars)
ggplot(best, aes(x = stars, y = n)) +
geom_histogram()
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
best$stars <- as.integer(best$stars)
View(best)
ggplot(best, aes(x = stars, y = n)) +
geom_histogram()
ggplot(best, aes(x = stars)) +
geom_histogram()
ggplot(best, aes(x = stars)) +
geom_histogram() +
facet_wrap(~continent)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
ggplot(best, aes(x = stars, color = rate)) +
geom_histogram() +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_line() +
facet_wrap(~continent)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
ggplot(best, aes(x = stars, y = n, fill = rate)) +
geom_line() +
facet_wrap(~continent)
ggplot(best, aes(x = stars, y = n, fill = rate)) +
geom_line()
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average")) %>%
group_by(continent, rate) %>%
count(stars)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
best <- corr %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
View(best)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(position = "stacked") +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(stat = "stacked") +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(position = "stack") +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(binwidth = 1) +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(binwidth = 5) +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram(binwidth = 0.5) +
facet_wrap(~continent)
ggplot(best, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
ggplot(corr, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa")) %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
ggplot(corr, aes(x = stars, fill = rate)) +
geom_histogram() +
facet_wrap(~continent)
perc <- corr %>%
count(continent, rate)
View(perc)
View(brands)
View(perc)
perc <- corr %>%
count(continent, rate) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2) %>%
datatable(colnames = c("Continent", "Rate", "Percentage"), options = list(paging = FALSE))
perc
View(perc)
perc <- corr %>%
count(continent, rate)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
group_by(continent, rate)  %>%
summarise(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc <- corr %>%
filter(continent != "Africa") %>%
group_by(continent, rate)  %>%
summarise(percentage = n()/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
View(corr)
perc <- corr %>%
filter(continent != "Africa") %>%
group_by(continent, rate)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate)
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
View(perc)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n/sum(continent)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
class(perc$n)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(n = as.numeric(perc$n)) %>%
mutate(percentage = n/sum(continent)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(n= as.numeric(perc$n)) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc$n <-
View(perc)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n/sum()*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
View(corr)
View(perc)
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa")) %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n()/n*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
View(perc)
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n/n()*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n/sum(n())*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
corr <- ramen_ratings %>%
mutate(continent = case_when(
country %in% asia ~ "Asia",
country %in% europe ~ "Europe",
country %in% oceania ~ "Oceania",
country %in% america ~ "America",
country %in% africa ~ "Africa")) %>%
mutate(rate = case_when(
stars >= 4 ~ "Best",
stars < 4 ~ "Average"))
perc <- corr %>%
filter(continent != "Africa") %>%
select(continent, rate) %>%
count(continent, rate) %>%
mutate(percentage = n/sum(n())*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
count(continent, rate) %>%
mutate(percentage = n/sum(n())*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
count(continent, rate) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
count(continent, rate) %>%
group_by(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
perc <- corr %>%
filter(continent != "Africa") %>%
group_by(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc <- corr %>%
filter(continent != "Africa") %>%
count(continent, rate) %>%
group_by(continent) %>%
mutate(percentage = n/sum(n)*100)  %>%
mutate_if(is.numeric, round, digits = 2)
perc
ggplot(perc, aes(x = continent, y = percentage, fill = rate)) +
geom_bar()
ggplot(perc, aes(x = continent, y = percentage, fill = rate)) +
geom_bar(stat = "identity")
